webpackJsonp([16],{cqMA:function(e,t){},yY4b:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s={name:"myset",data:function(){var e=this;return{showdata:!0,showpass:!1,showphone:!1,user_info:{},showname:!1,avatar:"",name:"",user_tpc:"",resetForm:{newpwd:"",renewpwd:""},resetFormRules:{newpwd:[{required:!0,validator:function(e,t,o){t?t.toString().length<6||t.toString().length>12?o(new Error("密码长度为6 - 12个字符")):o():o(new Error("请输入新密码"))},trigger:"blur"}],renewpwd:[{required:!0,validator:function(t,o,s){""===o?s(new Error("请再次输入密码")):o!==e.resetForm.newpwd?s(new Error("两次输入密码不一致!")):s()},trigger:"blur"}]},ruleForm:{mobile:"",captcha:"",newmobile:""},show:!0,count:"",timer:null}},inject:["app"],mounted:function(){this.user_tpc=this.$com.getCookies("user_tpc"),this._GetUserInfo()},methods:{_GetUserInfo:function(){var e=this;this.$api.GetUserInfo().then(function(t){e.showdata=!1,1==t.code&&(e.user_info=t.data,e.user_info.mobile=e.user_info.mobile.substr(0,3)+"****"+e.user_info.mobile.substr(7))})},_Profile:function(){var e=this;this.$api.Profile(this.avatar||this.user_info.avatar,this.name||this.user_info.nickname).then(function(t){1==t.code?e.$com.showToast("修改成功","success"):e.$com.showToast(t.msg||"稍后在试"),e._GetUserInfo(),e.app._GetUserInfo()})},changename:function(){var e=this;this.$prompt("请输入昵称","修改昵称",{confirmButtonText:"确定",cancelButtonText:"取消",center:!0,inputValidator:function(t){return!t||t.trim().length<1?"昵称不能为空":/^[\w\u4e00-\u9fa5]{1,6}$/.test(t)?void(e.name=t):"昵称格式不正确"},inputPlaceholder:this.user_info.nickname}).then(function(){e._Profile()})},handleAvatarSuccess:function(e,t){this.user_info.avatar=URL.createObjectURL(t.raw)},beforeAvatarUpload:function(e){var t="image/jpeg"==e.type||"image/png"==e.type||"image/gif"==e.type,o=e.size/1024/1024<2;return t||this.$com.showToast("上传头像图片只能是 JPG 格式!"),o||this.$com.showToast("上传头像图片大小不能超过 2MB!"),t&&o},handleUpload:function(e){var t=this;this.$api.CommonUpload(e.file).then(function(e){1==e.code&&(t.user_info.avatar=e.data.url,t._Profile())})},go_changepass:function(){var e=this;this.$refs.resetForm.validate(function(t){if(!t)return!1;e.$api.ResetPassword(e.resetForm.newpwd,e.resetForm.renewpwd).then(function(t){1==t.code?(e.$com.showToast("修改成功","success"),e.showpass=!1):e.$com.showToast(t.msg)})})},_SmsSend:function(){var e=this;this.$com.checkPhone(this.ruleForm.newmobile)?this.$api.SmsSend(this.ruleForm.newmobile,"changemobile").then(function(t){e.showbtn=!1,1==t.code?(e.send(),e.$com.showToast(t.msg,"success"),e.ruleForm.captcha=t.data):e.$com.showToast(t.msg)}):this.$com.showToast("请输入正确的手机号")},send:function(){var e=this;this.timer||(this.count=60,this.show=!1,this.timer=setInterval(function(){e.count>0&&e.count<=60?e.count--:(e.show=!0,clearInterval(e.timer),e.timer=null)},1e3))},gonext:function(){var e=this;""==this.captcha?this.$com.showToast("请输入验证码"):""==this.ruleForm.newmobile?this.$com.showToast("请输入手机号"):this.$api.ChangeMobile(this.ruleForm.newmobile,this.ruleForm.captcha).then(function(t){1==t.code?(e.$com.showToast("修改成功","success"),e._GetUserInfo(),e.showphone=!1):e.$com.showToast(t.msg||"稍后再试")})},accountinput:function(){this.ruleForm.mobile=this.ruleForm.mobile.replace(/[^\d]/g,"")},accountinputnew:function(){this.ruleForm.newmobile=this.ruleForm.newmobile.replace(/[^\d]/g,"")},captchainput:function(){this.ruleForm.captcha=this.ruleForm.captcha.replace(/[^\d]/g,"")}}},a={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"setbox"},[e._m(0),e._v(" "),o("div",{directives:[{name:"loading",rawName:"v-loading",value:e.showdata,expression:"showdata"}],staticClass:"setarea"},[o("el-row",[o("el-col",{staticClass:"label",attrs:{span:4}},[e._v("头像")]),e._v(" "),o("el-col",{attrs:{span:20}},[o("el-upload",{staticClass:"avatar-uploader",attrs:{action:"","show-file-list":!1,"on-success":e.handleAvatarSuccess,"before-upload":e.beforeAvatarUpload,"http-request":e.handleUpload}},[e.user_info.avatar?o("img",{staticClass:"avatar",attrs:{src:e.user_info.avatar}}):o("i",{staticClass:"el-icon-plus avatar-uploader-icon"}),e._v(" "),o("el-button",{attrs:{solt:""}},[e._v("修改")])],1)],1)],1),e._v(" "),o("el-row",[o("el-col",{staticClass:"label",attrs:{span:4}},[e._v("昵称")]),e._v(" "),o("el-col",{attrs:{span:12}},[e._v(e._s(e.user_info.nickname))]),e._v(" "),o("el-col",{attrs:{span:8}},[o("el-button",{on:{click:e.changename}},[e._v("修改")])],1)],1),e._v(" "),o("el-row",[o("el-col",{staticClass:"label",attrs:{span:4}},[e._v("修改手机号")]),e._v(" "),o("el-col",{attrs:{span:12}},[e._v(e._s(e.user_info.mobile))]),e._v(" "),o("el-col",{attrs:{span:8}},[o("el-button",{on:{click:function(t){e.showphone=!0}}},[e._v("修改")])],1)],1),e._v(" "),o("el-row",[o("el-col",{staticClass:"label",attrs:{span:4}},[e._v("登录密码")]),e._v(" "),o("el-col",{attrs:{span:12}},[e._v("更改密码")]),e._v(" "),o("el-col",{attrs:{span:8}},[o("el-button",{on:{click:function(t){e.showpass=!0}}},[e._v("修改")])],1)],1),e._v(" "),o("el-dialog",{attrs:{title:"更改密码",visible:e.showpass,center:""},on:{"update:visible":function(t){e.showpass=t}}},[o("el-form",{ref:"resetForm",attrs:{model:e.resetForm,rules:e.resetFormRules}},[o("el-form-item",{attrs:{label:"新密码","label-width":"120px",prop:"newpwd"}},[o("el-input",{attrs:{autocomplete:"off",type:"password",maxlength:"12",minlength:"6"},model:{value:e.resetForm.newpwd,callback:function(t){e.$set(e.resetForm,"newpwd",t)},expression:"resetForm.newpwd"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"重复新密码","label-width":"120px",prop:"renewpwd"}},[o("el-input",{attrs:{autocomplete:"off",type:"password",maxlength:"12",minlength:"6"},model:{value:e.resetForm.renewpwd,callback:function(t){e.$set(e.resetForm,"renewpwd",t)},expression:"resetForm.renewpwd"}})],1)],1),e._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.showpass=!1}}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:e.go_changepass}},[e._v("确 定")])],1)],1),e._v(" "),o("el-dialog",{attrs:{title:"修改手机号",visible:e.showphone,center:""},on:{"update:visible":function(t){e.showphone=t}}},[o("el-form",{ref:"form",staticClass:"loginform",attrs:{model:e.ruleForm,"label-width":"120px"}},[o("el-form-item",{attrs:{prop:"mobile",label:"原手机号",required:""}},[o("el-input",{attrs:{disabled:"",readonly:"",clearable:"",autocomplete:"off",maxlength:"11"},on:{input:e.accountinput},model:{value:e.user_info.mobile,callback:function(t){e.$set(e.user_info,"mobile",t)},expression:"user_info.mobile"}})],1),e._v(" "),o("el-form-item",{attrs:{prop:"mobile",label:"新手机号",required:""}},[o("el-input",{attrs:{placeholder:"新手机号",clearable:"",autocomplete:"off",maxlength:"11"},on:{input:e.accountinputnew},model:{value:e.ruleForm.newmobile,callback:function(t){e.$set(e.ruleForm,"newmobile",t)},expression:"ruleForm.newmobile"}})],1),e._v(" "),o("el-form-item",{attrs:{prop:"captcha",label:"验证码",required:""}},[o("el-input",{staticStyle:{width:"70%"},attrs:{placeholder:"请输入验证码",maxlength:"4",autocomplete:"off"},on:{input:e.captchainput},model:{value:e.ruleForm.captcha,callback:function(t){e.$set(e.ruleForm,"captcha",t)},expression:"ruleForm.captcha"}}),e._v(" "),o("el-button",{staticStyle:{width:"28%"},attrs:{icon:"el-icon-mobile-phone",type:"success",disabled:e.disabled=!e.show},on:{click:e._SmsSend}},[o("span",{directives:[{name:"show",rawName:"v-show",value:e.show,expression:"show"}]},[e._v("获取验证码")]),e._v(" "),o("span",{directives:[{name:"show",rawName:"v-show",value:!e.show,expression:"!show"}],staticClass:"count"},[e._v(e._s(e.count)+" s")])])],1)],1),e._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.showphone=!1}}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:e.gonext}},[e._v("确 定")])],1)],1)],1)])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"score_top"},[t("div",{staticClass:"iconbox"},[t("div",{staticClass:"name"},[this._v("账户设置")])])])}]};var n=o("VU/8")(s,a,!1,function(e){o("cqMA")},"data-v-64770858",null);t.default=n.exports}});
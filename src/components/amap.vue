<template>
  <div :id="id" :style="{width:width+'px',height:height+'px',margin:'34px auto'}" class="m-map">

  </div>
</template>

<script>
  export default {
    props: {
      width: {
        type:Number,
        default:300
      },
      height: {
        type:Number,
        default:300
      },
      point:{
        type:Array,
        default(){
          return [116.46,39.92]
        }
      }
    },
    data(){
      return {
        id:`map`,
        key:'515ce08f25f0fc3031ddc376eb6ed114'
      }
    },
    watch:{
      point: function(val,old){
        this.map.setCenter(val)
        this.marker.setPosition(val)
      }
    },
    mounted() {
      let self = this
      self.id = `map${Math.random().toString().slice(4, 6)}`
console.log(self.point)
      console.log(AMap)
      window.onmaploaded = () => {
        let map = new AMap.Map(self.id, {
          resizeEnable: true,
          zoom: 11,
          center: self.point
        })
        // self.map = map
        console.log(map)
        // new AMap.plugin('AMap.ToolBar', () => {
        //   let toolbar = new AMap.ToolBar();
        //   new AMap.addControl(toolbar)
        //   let marker = new AMap.Marker({
        //     icon: 'https://webapi.amap.com/theme/v1.3/markers/n/mark_b.png',
        //     position: self.point
        //   })
        //   self.marker = marker
        //   marker.setMap(map)
        // })
      }
      // const url = `https://webapi.amap.com/maps?v=1.4.10&key=${self.key}&callback=onmaploaded`
      // let jsapi = document.createElement('script')
      // jsapi.charset = 'utf-8'
      // jsapi.src = url
      // document.head.appendChild(jsapi)
    },
  }
</script>
<style scoped lang="scss">
  .m-map{
    background-color: #fff;
  }
</style>
